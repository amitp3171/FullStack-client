/* src/styles/ChatArea.css */
/* ---------- Theme tokens ---------- */
:root{
  /* neutrals */
  --surface:    #ffffff;
  --surface-2:  #f8fafc;
  --surface-3:  #f3f4f6;
  --text:       #0f172a;
  --muted:      #6b7280;
  --border:     #e5e7eb;

  /* tables */
  --th-bg:  #f3f4f6;
  --tr-alt: #f9fafb;

  /* accents (brand) */
  --accent:       #2563eb;
  --accent-hover: #1d4ed8;
  --warn:         #f59e0b;
  --warn-hover:   #d97706;

  /* subtle chips / controls */
  --chip-bg:     #f9fafb;
  --chip-border: #d1d5db;

  /* code blocks / editors */
  --code-bg: #1118270a;
  --ring: 0 0 0 4px rgba(37, 99, 235, .25);

  /* user bubble (light) */
  --user-bubble-bg:     #eef2f7;  /* lighter grey */
  --user-bubble-text:   #0f172a;
  --user-bubble-border: #dbe2ea;
}

html[data-theme="dark"]{
  --surface:   #0b1220;
  --surface-2: #0f172a;
  --surface-3: #111827;
  --text:      #e5e7eb;
  --muted:     #9aa4b2;
  --border:    #1f2937;

  --th-bg:  #0f172a;
  --tr-alt: #0c1320;

  --chip-bg:     #0f172a;
  --chip-border: #1f2937;

  --code-bg: #0b1220;

  /* keep brand accents identical */
  --accent:#2563eb;
  --accent-hover:#1d4ed8;
  --warn:#f59e0b;
  --warn-hover:#d97706;

  /* user bubble (dark) */
  --user-bubble-bg:     #1f2937;
  --user-bubble-text:   #e5e7eb;
  --user-bubble-border: #334155;
}

/* ---------- Chat area ---------- */
.chat-area{
  position:relative;
  width:85%;
  flex:1 1 auto;
  min-height:0;
  max-height:100%;
  padding:20px;
  margin:24px auto;
  border-radius:16px;
  background:transparent;
  color:var(--text);

  overflow-y:auto;
  display:flex;
  flex-direction:column;
  gap:10px;
  margin-right:0;

  align-items:stretch;
  justify-content:flex-start;
}

/* ---------- Bubbles ---------- */
.chat-bubble{
  max-width:70%;
  padding:10px 14px;
  border-radius:14px;
  line-height:1.4;
  word-wrap:break-word;
  font-size:.95rem;
  color:var(--text);
  background:var(--surface-3);
  border:1px solid var(--border);
}

.user-bubble{
  align-self:flex-end;
  background:var(--user-bubble-bg);
  color:var(--user-bubble-text);
  border:1px solid var(--user-bubble-border);
  border-bottom-right-radius:4px;
}

.bot-bubble{
  align-self:flex-start;
  background:var(--surface-3);
  color:var(--text);
  border-bottom-left-radius:4px;
}

.edited-label{
  font-size:.75rem;
  color:var(--muted);
  margin-top:4px;
  font-style:italic;
}

/* ---------- Results ---------- */
.results-table{ margin-top:8px; overflow-x:auto; }

.sql-result{ position:relative; overflow:visible; }

.sql-result table{
  width:100%;
  border-collapse:collapse;
  font-size:.9rem;
  background:var(--surface);
  color:var(--text);
  border-radius:8px;
  overflow:hidden;
  border:1px solid var(--border);
}

.sql-result th,
.sql-result td{
  border:1px solid var(--border);
  padding:6px 10px;
  text-align:left;
}

.sql-result th{ background:var(--th-bg); font-weight:600; }

.sql-result tr:nth-child(even){ background:var(--tr-alt); }

/* ---------- Tiny icon buttons (Run / Edit, etc.) ---------- */
.query-actions{
  margin-top:8px;
  display:flex;
  gap:6px;
}

.icon-btn{
  width:28px;
  height:28px;
  display:grid;
  place-items:center;
  border-radius:8px;
  border:1px solid var(--chip-border);
  background:transparent;
  color:var(--text);
  cursor:pointer;
  padding:0;
  transition: background .15s ease, border-color .15s ease, transform .05s ease, box-shadow .15s ease;
}
.icon-btn:hover{
  background:var(--surface-2);
  border-color:var(--border);
}
.icon-btn:active{ transform: translateY(1px); }
.icon-btn:focus-visible{ outline:none; box-shadow: var(--ring); }
.icon-btn svg{ width:14px; height:14px; display:block; }

/* legacy button classes kept for compatibility (unused now) */
.run-query-btn,
.edit-query-btn{ display:none; }

/* ---------- Inline SQL editor ---------- */
.sql-editor{
  width:100%;
  font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
  padding:10px;
  border-radius:6px;
  border:1px solid var(--border);
  margin-top:10px;
  resize:vertical;
  background:var(--surface);
  color:var(--text);
}

.modal-actions{
  display:flex;
  justify-content:flex-end;
  gap:10px;
  margin-top:8px;
}

.modal-actions button{
  padding:5px 12px;
  border:1px solid var(--border);
  background:var(--surface-2);
  color:var(--text);
  border-radius:6px;
  cursor:pointer;
}
.modal-actions button:last-child{
  background:var(--accent);
  color:#fff;
  border-color:transparent;
}

/* ---------- Typing indicator ---------- */
.loading-indicator{
  align-self:center;
  font-size:.85rem;
  color:var(--muted);
  font-style:italic;
}

.typing{ display:inline-flex; gap:6px; padding:8px 12px; align-items:center; }

.dot{
  width:6px; height:6px; border-radius:50%;
  display:inline-block;
  background:var(--muted);
  animation:chat-bounce 1.2s infinite ease-in-out;
}
.dot:nth-child(2){ animation-delay:.15s; }
.dot:nth-child(3){ animation-delay:.3s; }

@keyframes chat-bounce{
  0%,80%,100%{ transform:translateY(0); opacity:.35; }
  40%{ transform:translateY(-4px); opacity:1; }
}

/* ---------- SQL code block ---------- */
.sql-block{
  margin-top:4px;
  background:var(--code-bg);
  border:1px solid var(--border);
  border-radius:8px;
  padding:8px 10px;
  white-space:pre-wrap;
  font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
  font-size:.9rem;
  color:var(--text);
}

/* ---------- Export controls ---------- */
.export-controls{
  display:flex;
  justify-content:flex-end;
  align-items:center;
  margin-bottom:8px;
  gap:8px;
}

.export-wrap{ position:relative; display:inline-block; }

.export-toggle{
  display:inline-flex; align-items:center; gap:6px;
  padding:6px 10px;
  font-size:.9rem;
  background:var(--chip-bg);
  color:var(--text);
  border:1px solid var(--chip-border);
  border-radius:8px;
  cursor:pointer;
  transition:background .15s ease, border-color .15s ease, transform .05s ease, box-shadow .15s ease;
}
.export-toggle:hover{ background:var(--surface-2); border-color:var(--border); }
.export-toggle:active{ transform:translateY(1px); }
.export-toggle:focus-visible{ outline:none; box-shadow: var(--ring); }

/* dropdown menu: open ABOVE the button (drop-up) */
.export-menu{
  position: absolute;
  right: 0;
  bottom: calc(100% + 6px); /* ⬅️ anchor above the toggle */
  top: auto;                /* ⬅️ remove top anchoring */
  width: 160px;
  background: var(--surface);
  color: var(--text);
  border: 1px solid var(--border);
  border-radius: 8px;
  box-shadow: 0 -8px 24px rgba(0,0,0,.18); /* ⬅️ shadow pointing upward */
  padding: 6px;
  z-index: 20;
}


.export-item{
  width:100%;
  text-align:left;
  background:transparent;
  border:none;
  padding:8px 10px;
  border-radius:6px;
  cursor:pointer;
  font-size:.9rem;
  margin-left:0 !important;
  color:var(--text);
}
.export-item:hover{ background:var(--surface-2); }
